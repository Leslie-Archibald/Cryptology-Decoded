<!--History Page for the website -->
<!DOCTYPE html>

<html lang="en">
<head>
	<link rel="stylesheet" href="CSS_Sheet_One.css">
	<title>Cryptology Decrypted: The Enigma Machine</title>
</head>

<!--Body Starts Here -->
<body>
	<!-- Header -->
	<header>
		<h1>Cryptology: Decoded</h1>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/Home_Page.html">Home</a></button>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/Ancient_Cryptology.html">Ancient Cryptology</a></button>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/Early_Cryptology.html">Early Cryptology</a></button>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/WW1_Cryptology.html">WWI Cryptology</a></button>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/The_Enigma_Machine.html">The Enigma Machine</a></button>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/Purple_Code.html">Japanese Ciphers of WWII</a></button>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/Cryptology_Today.html">Modern Cryptology</a></button>
		<button><a href="file:///C:/Users/Leslie%20Archibald/Desktop/Cryptography_Website/Sources.html">Sources</a></button>
	</header>
	
	<h3>the engima machine</h3>
	
	<p>Of the cipher systems used during World War II, the Enigma machine is probably the most well known. It had been in use for almost two decades commercially 
		at this point, but the model used by the Nazi military was much more complex. It consisted of five chief variable components: a plugboard, three rotors, 
		a half-rotor reflector, and a moveable ring between the rotors. Using the standard 26 letter Latin alphabet, these variable components together could spit 
		out any one of 3 x 10114 possible combinations. To provide a bit of context to the sheer enormity of this number, current estimates put the number of atoms 
		in the entire observable universe at a value of 1079, a number so small that you would need 3 x 1035 observable universes to have enough atoms to equal the 
		number of enigma combinations. The reflector also ensured that any Enigma machine could be used to decrypt a message provided that it was set to the same 
		configurations as that of the one used to compose the message. This self-reciprocal nature eliminated the need for the machine to be designed with 
		separate encryption and decryption modes but also had a hidden flaw. No letter could ever be encrypted by itself, a flaw that codebreakers would later 
		exploit. <p>
		
	<p>Each German military branch had its own distinctive version of the Enigma machine, but in essence, they all worked the same way. It took a team of two to run 
		the machine, one to do the typing and the other to record the output. The first operator would set up the machine according to pre-distributed key lists. 
		Doing this involved changing the order of rotors, the starting position of the alphabet rings, the connections used on the plugboard, and the starting position 
		of the rotor. The first three were standardized and remained unchanged throughout the day. A standard initial position for the rotors also existed, but it wasn’t 
		meant to remain static throughout the day. Instead, its purpose was for transmitting a new starting position for the rotors. First, the rotors would be rotated 
		until the letters displayed through the lid of the machine matched that of the standardized initial position. After that, the operators would select three new 
		letters to use as the rotors’ initial position indicators and type them in twice. The resulting string of six characters was recorded and transmitted at the beginning 
		of the message. When entered into a machine configured using that day’s standard settings, it would decrypt the string and reveal the initial positions the sender 
		had used. Once the new rotor settings had successfully been encrypted and transmitted, the operators would set the rotors to the letters they had decided upon and 
		begin the encryption. One man would type in the text, while the other would write down the ensuing ciphertext. Upon transmission, the receivers merely set the rotors 
		to the letters they had been sent earlier and typed in the ciphertext. The reflector in the machine reversed the encryption, causing plaintext letters to be displayed.<p> 

	<p>The extreme degree of variability gave Enigma its power, but even before codebreakers were able to take a crack at it there were already some problems with it. As 
		previously mentioned, the very nature of the reflector that eliminated the need for separate encryption and decryption modes also ensured that no letter could encrypt 
		itself. The transmission, too, of the starting position of the rotors was not secure. Although the machine swapped cipher alphabets with each letter, having a standardized 
		position used to encrypt that starting position ensured that every key would use identical polyalphabetic substitution. The repetition of this key also built relationships 
		between the letters of the encrypted string. With enough keys gathered, this would help facilitate the identification of the initial settings. This was worrisome enough, 
		but not the most egregious security breach. At times the operators would send the key in the clear as the first three letters of the ciphertext - a blatant vulnerability 
		caused by human error.</p>
	
	<p>The first country to put considerable time and effort into cracking the Enigma cipher was Poland, with its tiny cipher bureau. Knowing that their proximity to the increasingly 
		hostile Germany put them at great risk, the Poles began to monitor all communication in and out of the embassy in Warsaw. Everything, from things as advanced as radio 
		communications to the more simplistic postal deliveries, was carefully scrutinized. In the end, this attention to detail would pay off. A package bound for the German ambassador 
		arrived one Saturday in 1930 and was intercepted by the intelligence communities. It contained an Enigma machine. Mail was not delivered on the weekend, so the Poles had unlimited 
		access to it for forty-eight hours. During this time they meticulously recorded information about it and took detailed pictures of the device. They then carefully packaged it back 
		up and delivered it on Monday. Although the Germans were unaware of it, the attack on Enigma had begun.</p>
		
	<p>The Polish bureau quickly theorized that machine codes such as Enigma could be broken using mathematics. To that end, they recruited a few students from Poznan University - 
		Marian Rejewski, Henryk Zygalski, and Jerzy Rozycki - to help them decipher the Enigma. Of the three Rejewski perhaps was the most brilliant. His method of using math, specifically 
		the concepts of permutations, rather than linguistics to try and glean information about the machine was a novel idea. It would quickly yield some results. Within a matter of weeks, 
		Rejewski was able to create tables based on cycles and groups that could be used to accurately work out the order of the rotors in the machine, as well as which of the five available 
		rotors were in use. Despite this impressive feat, however, Enigma still could not be deciphered because the internal wiring of the machine was unknown. Working out the rotor positions 
		was already a great feat of mathematics, enough to cement Rejewski’s place in history, but the young Pole couldn’t afford to stop there. He tried, and failed, to work out the structure
		of the internal wiring. At this point, Rejewski needed more information to build off of. He got it from an unlikely source. To the west in Germany, the French embassy received an 
		unusual visitor. His name was Hans-Thilo Schmidt, a member of the German coding office. He offered to sell secrets relating to the Enigma machine, an offer that the French were wary 
		of but ultimately accepted. In exchange for a significant sum of money, he gave them access to documents - including two pages of daily keys for the enigma settings - to photograph. 
		Schmidt would eventually become a double agent and continued to feed the French and their allies information about the cipher machine in the forms of daily settings, operating procedures, 
		and even the instruction manual. France and its British allies tried linguist based attacks using this information but were unable to make any progress. It was only after this that they 
		would offer it to the Polish cipher bureau.</p>

	<p>	The information given to the Poles would be the missing piece needed to facilitate one of the greatest feats of both cryptanalysis and reverse engineering. Now Rejewski was able to 
		start trying to work out how the rotors were wired together. Returning to his permutation groups, the mathematician was able to develop a system of equations that were used to solve for 
		the right rotor’s internal wiring. With his knowledge of the key, he was able to factor out the plugboard position. An assumption was also made that the keyboard's connection to the first 
		rotor was identical to the one on the commercial machine so Rejewski factored that out too. Using the rest of the information about the standardized settings of the day, he successfully 
		calculated the wiring of the rightmost rotor. When the order of rotors changed, he simply repeated the process and got the wiring of the new rightmost one. Once he knew the wiring of two 
		of the rotors in the machines, it was simple to calculate that of the third and the connections to the reflector. Soon the Poles were manufacturing their own Enigma machines to aid in 
		decryption. There was just one problem with Rejewski’s calculations. Unlike the commercial machines, the military Enigmas had different connections from the keyboard to the rotor. 
		It was not in the standard German keyboard order, QWERTZ, like the mathematician, had assumed. This meant that upon trying to enter in a message for decryption only garbled plaintext 
		came out. Knowing that his work on the rotors had to be correct, Rejewski returned to the wiring of the keyboard. He tried alphabetical order instead, basing the hypothesis on the well-known 
		fact that Germans had a love of order. It worked. Without ever seeing or examining a military-grade Enigma machine, Rejewski was able to recreate it perfectly using nothing but mathematics.</p>
		
	<p>Now that they were in possession of their own Enigma machines, the cipher bureau began the tedious work of figuring out the proper settings to use on a daily basis. To help facilitate this 
		an impressive catalog of cycles and starting positions of the rotors was amassed. All of the information could be calculated by hand, but machines also partly automated the task. The mechanism 
		was called bomba kryptologiczna, named for the ticking sound it produced as it cycled through various key tests. It used eighteen rotors to run through the various key combinations, speeding 
		up the process immensely. Soon six bombas had been manufactured and were cranking through seventeen thousand initial settings a day. Zygalski produced perforated sheets that were used to look 
		for starting positions of the rotors. With these methods, the Poles were able to find the daily key in as little as fifteen minutes and were deciphering about seventy-five percent of intercepted 
		communications. The method was successful until 1938 when the Germans added new rotors, which greatly increased the number of bombas needed to crack the code. Resources were running low, and the 
		Germans were getting closer and closer to being prepared to invade. The work on Enigma was no longer something that the Poles could do on their own. An invitation was sent out to France and Britain 
		to come to look at their work. To the immense shock of the delegations, the Poles revealed the working Enigma doubles they had created and their methods. Where well-funded groups in France and 
		England failed, the tiny Polish cipher bureau had succeeded. Each delegation was provided with their own Enigma machines, which they smuggled out of Poland. Rejewski, Zygalski, and Rozycki 
		evacuated as Germany invaded their country. The trio would work their way to France where they were assigned to an intelligence station near Paris. There they would continue to decipher Enigma keys. 
		As Germany began to slowly occupy France they moved south. Rozycki would be sent to Algeria for a short time and would end up perishing when his homeward-bound ship sank. Rejewski and Zygalski 
		continued to work, but they were gradually becoming less and less involved with the Enigma machine. After escaping to Britain during the fall of France, the pair were assigned the task of breaking 
		field communications encrypted by hand. They would never work on Enigma again.</p> 

	<p>Britain picked up where Poland left off with its establishment of a code and cipher bureau at Bletchley Park. It was around this time that the Germans began to make mistakes. In a sense, it was not 
		nature of the Enigma that doomed it, it was the human operators. Although key transmission procedures had been tightened up, the way officers selected their keys was haphazard. The initials or first 
		parts of their significant other were common choices. Certain German customs also provided the British with indispensable clues. One such custom was the yearly birthday message to Hitler, which came 
		from every group in the military. The intercepted messages would become cribs, or known-plaintext, that could then be used to find daily keys. Cribs and breaks had reduced the number of combinations 
		needing to be tested from 3x10114 to 1023 combinations. The use of cribs was indispensable, but in a situation where time was of the essence, it was also impractical. If the Bletchley cryptanalysts 
		couldn’t crack the code in time, they could miss out on life-saving communication. A decision was made to build a machine, similar to that of the Polish bomba. Alan Turing, an eccentric mathematical 
		genius, had proposed the logic that would be used in this machine in his 1936 paper On Computable Numbers with an Application to the Entscheidungsproblem. Using the scientific method and the theory of 
		probability, Turning suggested that instead of finding a correct answer, it would be better to find the wrong answers and use them to cut large chunks of possible answers in the group. It was a task 
		human minds were unable to do quickly enough, and thus he built the Turing bombe. The machine was much larger than the bomba, containing several dozen rotors instead of just eighteen. These rotors 
		would rapidly run through the keys to see if it was possible to prove them wrong. If it was, the rotor would keep spinning. When it came to a key that it couldn’t disprove, however, that specific 
		rotor would stop. The possible key would be used to set up one of the enigma doubles and then ciphertext would be entered using the keyboard. If the output was a plaintext message, the proper key had 
		been found. If not, they would progress to the next stopped rotor and try that combination. Soon the English had brought the time it took to break a key down to fourteen minutes.</p> 

	<p>The Germans would continue to try and improve Enigma’s security, but now that the chink in its armor had been discovered the British could not be held back for long. One by one they broke into the 
		different versions various branches of the military used - often due to mistakes made by the Germans. An argument between the Luftwaffe and Panzer generals when the Germans were completing their invasion 
		of France provided enough information to help Bletchley break into the air force's Enigma. They then turned their attention to the more complex naval Enigma. Upon finding out that there were Nazi trawlers 
		the arctic for the purpose of reporting weather conditions, the British promptly captured them. Onboard they found two months’ worth of keys, and soon the naval Enigma fell. Britain promptly went on the 
		attack and began eradicating the German u-boats with their new information. A more advanced version of the naval Enigma, codenamed Shark, would be broken with keys taken from the sinking submarine U-559, 
		rendering that code useless as well. With the progress on breaking Enigma going so well, part of Bletchley turned their attention to deciphering a cipher used by the highest command of the Nazi society - 
		the Lorenz cipher. Much like its lower military counterpart, Lorenz would be broken due to human error. Originally conceived as a truly random one-time pad cipher using a paper tape of random characters; 
		the difficulties in ensuring each command had the identical character sequences forced it to be reimagined as a pseudo-random rotor-based machine. This in and of itself gave Bletchley great insights into 
		the machine, but a colossal mistake was what truly doomed it. A German operating team sent a message in the Lorenz cipher, only to be told that it hadn’t been received. In a serious breach of protocol the 
		two teams reset their machines to the previously used settings. This in and of itself was already a huge blunder, and it was about to get worse. The message being sent was a long one, and the second time 
		around the operators didn’t type it in exactly as before. The British intercepted both, and now had in their possession two different ciphertexts that had near-identical plaintext counterparts.Bletchley 
		went to work in earnest on cracking the Lorenz machine. Realizing that the bombe would be too slow for the task at hand, a new machine began to be constructed. Designed by a man named Tommy Flowers, it 
		would be christened Colossus. Colossus was a proto-computer that was entirely electrical rather than electromechanical like the Turing bombe. It could analyze approximately five-thousand ciphertext characters 
		a minute and was much faster than the Turing bombe. The information that broken Lorenz codes provided allowed the Allied powers to better understand the German line of thought and plans at the highest level 
		of the chain of command.</p>


